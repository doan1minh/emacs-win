gnutls_pkcs12_simple_parse(3)       gnutls       gnutls_pkcs12_simple_parse(3)



NNAAMMEE
       gnutls_pkcs12_simple_parse - API function

SSYYNNOOPPSSIISS
       ##iinncclluuddee <<ggnnuuttllss//ppkkccss1122..hh>>

       iinntt  ggnnuuttllss__ppkkccss1122__ssiimmppllee__ppaarrssee((ggnnuuttllss__ppkkccss1122__tt _p_1_2,, ccoonnsstt cchhaarr ** _p_a_s_s_-
       _w_o_r_d,, ggnnuuttllss__xx550099__pprriivvkkeeyy__tt ** _k_e_y,, ggnnuuttllss__xx550099__ccrrtt__tt **** _c_h_a_i_n,, uunnssiiggnneedd
       iinntt  **  _c_h_a_i_n___l_e_n,,  ggnnuuttllss__xx550099__ccrrtt__tt  ****  _e_x_t_r_a___c_e_r_t_s,,  uunnssiiggnneedd iinntt **
       _e_x_t_r_a___c_e_r_t_s___l_e_n,, ggnnuuttllss__xx550099__ccrrll__tt ** _c_r_l,, uunnssiiggnneedd iinntt _f_l_a_g_s));;

AARRGGUUMMEENNTTSS
       gnutls_pkcs12_t p12
                   -- undescribed --

       const char * password
                   optional password used to decrypt the structure,  bags  and
                   keys.

       gnutls_x509_privkey_t * key
                   a structure to store the parsed private key.

       gnutls_x509_crt_t ** chain
                   the corresponding to key certificate chain (may be NNUULLLL)

       unsigned int * chain_len
                   will be updated with the number of additional (may be NNUULLLL)

       gnutls_x509_crt_t ** extra_certs
                   optional pointer to receive an array of additional certifi-
                   cates found in the PKCS12 structure (may be NNUULLLL).

       unsigned int * extra_certs_len
                   will be updated with the number of additional certs (may be
                   NNUULLLL).

       gnutls_x509_crl_t * crl
                   an  optional  structure  to  store  the  parsed CRL (may be
                   NNUULLLL).

       unsigned int flags
                   should be zero or one of GNUTLS_PKCS12_SP_*

DDEESSCCRRIIPPTTIIOONN
       This function parses a PKCS12 structure in   _p_k_c_s_1_2  and  extracts  the
       private  key,  the corresponding certificate chain, any additional cer-
       tificates and a CRL.

       The  _e_x_t_r_a___c_e_r_t_s and  _e_x_t_r_a___c_e_r_t_s___l_e_n parameters are optional and  both
       may  be  set to NNUULLLL. If either is non-NNUULLLL, then both must be set. The
       value for  _e_x_t_r_a___c_e_r_t_s is allocated using ggnnuuttllss__mmaalllloocc(()).

       Encrypted PKCS12 bags and PKCS8 private keys are  supported,  but  only
       with password based security and the same password for all operations.

       Note that a PKCS12 structure may contain many keys and/or certificates,
       and there is no way to identify which key/certificate  pair  you  want.
       For  this  reason this function is useful for PKCS12 files that contain
       only one key/certificate pair and/or one CRL.

       If the provided structure has encrypted fields but no password is  pro-
       vided then this function returns GGNNUUTTLLSS__EE__DDEECCRRYYPPTTIIOONN__FFAAIILLEEDD.

       Note  that  normally the chain constructed does not include self signed
       certificates, to comply with TLS' requirements. If, however,  the  flag
       GGNNUUTTLLSS__PPKKCCSS1122__SSPP__IINNCCLLUUDDEE__SSEELLFF__SSIIGGNNEEDD is specified then self signed cer-
       tificates will be included in the chain.

       Prior to using this function the PKCS 1122 structure  integrity  must  be
       verified using ggnnuuttllss__ppkkccss1122__vveerriiffyy__mmaacc(()).

RREETTUURRNNSS
       On  success,  GGNNUUTTLLSS__EE__SSUUCCCCEESSSS  (0)  is  returned, otherwise a negative
       error value.

SSIINNCCEE
       3.1.0

RREEPPOORRTTIINNGG BBUUGGSS
       Report bugs to <bugs@gnutls.org>.
       Home page: http://www.gnutls.org


CCOOPPYYRRIIGGHHTT
       Copyright (C) 2001-2014 Free Software Foundation, Inc..
       Copying and distribution of this file, with  or  without  modification,
       are  permitted  in  any  medium  without royalty provided the copyright
       notice and this notice are preserved.

SSEEEE AALLSSOO
       The full documentation for ggnnuuttllss is maintained as  a  Texinfo  manual.
       If  the /usr/share/doc/gnutls/ directory does not contain the HTML form
       visit

       hhttttpp::////wwwwww..ggnnuuttllss..oorrgg//mmaannuuaall//

gnutls                              3.3.10       gnutls_pkcs12_simple_parse(3)
